<!DOCTYPE html>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/ramda/0.25.0/ramda.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous" />
    <title>Data 4 Black Lives</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />

    <link href="https://fonts.googleapis.com/css?family=Space+Mono" rel="stylesheet" />
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" />
    <link rel="stylesheet" href="style.css" />

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <style media="screen">
        a.stream-link {
            background: #a31f34;
            text-decoration: underline;
            color: #fff !important;
            padding: 3px 6px;
        }
        
        a.stream-link:hover {
            background: rgba(0, 0, 0, 0);
            text-decoration: line-through;
            border: 2px solid #fff;
        }
    </style>
</head>

<body class="container reports">
    <div class="hidden-md hidden-lg hidden-xl" id="donate" target="_blank" class="hvr-grow">
        <a target="_blank" href="https://secure.actblue.com/donate/data-for-black-lives-1?refcode=d4blsite">Donate to D4BL</a
      >
    </div>

    <header style="">
      <nav class="navbar navbar-default tembus navbar-fixed-to">
        <div class="container">
          <div class="navbar-header">
            <button
              type="button"
              class="navbar-toggle"
              data-toggle="collapse"
              data-target="#myNavbar"
            >
              <i class="fa fa-angle-double-down"></i>
            </button>
          </div>
          <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="icons nav navbar-nav navbar-right">
              <li>
                <a
                  href="https://twitter.com/data4blacklives"
                  target="_blank"
                  class="icon fa-twitter"
                  ><span class="label">Twitter</span></a
                >
              </li>
              <li>
                <a
                  href="https://www.instagram.com/data4blacklives/?hl=en"
                  target="_blank"
                  class="icon fa-instagram"
                  ><span class="label">Twitter</span></a
                >
              </li>
              <li>
                <a
                  href="https://github.com/d4bl"
                  target="_blank"
                  class="icon fa fa-github"
                  ><span class="label" target="_top">Email</span></a
                >
              </li>
              <li id="join-us">
                <a
                  target="_BLANK"
                  href="https://docs.google.com/forms/d/e/1FAIpQLSdvyFQK_9n2GPvCRxuEetXHy4bsaeW99A22PprMSqjpMx-wWQ/viewform"
                >
                  JOIN US
                </a>
        </li>
        </ul>

        <ul class="nav navbar-nav navbar-right">
            <li><a href="/" class="hvrcenter">Home</a></li>
            <li><a href="https://shop.d4bl.org" class="hvrcenter">Shop</a></li>
            <li><a href="/programs.html" class="hvrcenter">Programs</a></li>
            <li>
                <a href="/conference.html" class="hvrcenter">Conference</a>
            </li>
            <li><a href="/events.html" class="hvrcenter">Events</a></li>

            <li><a href="/action.html" class="hvrcenter">Action</a></li>
            <li><a href="/press.html" class="hvrcenter">Press</a></li>
            <li><a href="/about.html" class="hvrcenter">About</a></li>
            <li>
                <a target="_BLANK" href="https://medium.com/@YESHICAN" class="hvrcenter">Blog</a
                >
                <li>

                  <a class="dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        Research
                        <span class="caret"></span>
                      </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                    <li><a href="/reports.html">Reportts</a></li>
                    <li><a href="covid19-data.html">COVID-19 Data</a></li>

                </ul>

            </li>


            </li>
        </ul>
    </div>
    </div>
    </nav>
    </header>
    <main class="col-sm-12" id="reports">
        <!-- Header -->

        <div class="row">
            <header class="col-md-12" id="header">
                <h1>Data for Black Lives</h1>
            </header>
        </div>
        <div id="app" class="row">
            <main id="reports" class="col-sm-12 modal-vue">
                <!-- overlay -->
                <div class="overlay" v-if="showModal" @click="showModal = false"></div>

                <!-- modal -->
                <div class="modal-vue">
                    <div class="modal" v-if="showModal">
                        <button class="close" @click="showModal = false">x</button>

                        <div v-html="modalText"></div>
                    </div>
                </div>
                <article class="green" v-for="entry in entries">
                    <h3 class="text-center">{{entry.gsx$title.$t}}</h3>
                    <p>
                        {{entry.gsx$excerpt.$t}}
                    </p>
                    <div class="flex actions">
                        <button @click="setAndFetchReport(entry.gsx$onlineurl.$t)" class="color-1">
                Read Online
              </button>
                        <a :href="getPdfLink(entry.gsx$printurl.$t)">
                Download PDF
              </a>
                    </div>
                </article>

                <!-- app -->
            </main>
        </div>

        <div class="clearfix"></div>
        <!-- Footer -->
        <footer class="row" id="footer">
            <ul class="icons hidden">
                <li>
                    <a href="https://twitter.com/data4blacklives" target="_blank" class="icon fa-twitter"><span class="label">Twitter</span></a
            >
          </li>
          <li>
            <a
              href="mailto:data4blacklives@gmail.com"
              class="icon fa-envelope-o"
              ><span class="label" target="_top">Email</span></a
            >
          </li>
        </ul>
        <ul class="copyright">
          <li>&copy; Data for Black Lives.</li>
          <li>Credits: <a href="https//d4bl.org">Data for Black Lives</a></li>
            </ul>
        </footer>
    </main>

    <div class="modal fade" id="squarespaceModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
              <span aria-hidden="true">Ã—</span
              ><span class="sr-only">Close</span>
            </button>
                    <h3 class="modal-title" id="lineModalLabel">EMAIL D4BL</h3>
                </div>
                <div class="modal-body email">
                    <!-- content goes here -->
                    <form method="POST" action="https//formspree.io/data4blacklives@gmail.com">
                        <label>Email Adress</label>
                        <input type="email" name="email" placeholder="Your email" />
                        <label>Message</label>
                        <textarea name="message" placeholder="Your message"></textarea>
                        <br />
                        <button class="btn btn-block btn-submit" type="submit">
                Send
              </button>
                    </form>
                </div>
                <div class="modal-footer hidden">
                    <div class="btn-group btn-group-justified" role="group" aria-label="group button">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-default" data-dismiss="modal" role="button">
                  Close
                </button>
                        </div>
                        <div class="btn-group btn-delete hidden" role="group">
                            <button type="button" id="delImage" class="btn btn-default btn-hover-red" data-dismiss="modal" role="button">
                  Delete
                </button>
                        </div>
                        <div class="btn-group" role="group">
                            <button type="button" id="saveImage" class="btn btn-default btn-hover-green" data-action="save" role="button">
                  Save
                </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/debug.addIndicators.min.js"></script>

    <script src="main.js"></script>
</body>

</html>
<script>
    var cv = new Vue({
        el: "#app",

        data: {
            entries: [],
            modalText: "",
            showModal: false,
            sheetUrl: "https://spreadsheets.google.com/feeds/list/11hWSj2hmUsJRWJOrBO3ybfzQtt8-r_WmAeV2gULNaGo/1/public/values?alt=json",
        },

        created() {
            this.fetchData();
        },

        methods: {
            getPdfLink(value) {
                let id = this.getID(value);
                console.log(id);
                return `https//docs.google.com/document/d/${id}/export?format=pdf`;
            },
            getID(value) {
                let val1, val2;
                if (value.includes("sharing")) {
                    val1 = value.lastIndexOf("/d/") + 3;
                    val2 = value.indexOf("/edit");
                } else {
                    val1 = value.lastIndexOf("/d/") + 3;
                    val2 = value.indexOf("/edit");
                }

                return value.slice(val1, val2);
            },
            setAndFetchReport(value) {
                this.showModal = true;
                //console.log("value", value);
                let code = this.getID(value);
                console.log(code);

                let url = `https://docs.google.com/document/d/${code}/pub?embedded=true`;
                return axios.get(url).then((value) => {
                    console.log(value);

                    let f = R.replace(/<style((.|\n|\r)*?)<\/style>/, "", value.data);

                    this.modalText = value.data;
                    console.log($("text"));
                });
            },
            fetchData: function() {
                var xhr = new XMLHttpRequest();
                var self = this;
                xhr.open("GET", self.sheetUrl);
                xhr.onload = function() {
                    self.entries = JSON.parse(xhr.responseText);

                    self.entries = self.entries.feed.entry;
                };
                xhr.send();
            },
        },
    });
</script>